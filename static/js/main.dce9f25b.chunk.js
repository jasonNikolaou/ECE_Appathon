(this["webpackJsonpmy-app"]=this["webpackJsonpmy-app"]||[]).push([[0],{21:function(e,a,t){e.exports=t(28)},28:function(e,a,t){"use strict";t.r(a);var i=t(0),n=t.n(i),l=t(19),c=t.n(l),r=t(5),o=t.n(r),s=t(8),d=t(9),v=t(10),m=t(2),u=t(16),h=t(14),_=t(3),p=t(12),N=function(e){var a=e.handleClickStationsWeather,t=e.handleClickAccessibleStations,i=e.fetchedData,l=e.error;return n.a.createElement("div",{className:"home mx-auto"},n.a.createElement("p",null," This is an application developed for the course:"),n.a.createElement("p",null,n.a.createElement("b",null,"Internet and Applications"),", NTUA ECE"),n.a.createElement("p",null,n.a.createElement("b",null,"Thessaloniki"),", Greece "),n.a.createElement("p",null,"Data taken from ",n.a.createElement("b",null,"IMET")," and ",n.a.createElement("b",null,"openweathermap"),"."),n.a.createElement("p",null,n.a.createElement("b",null,"Allow access to your location")," in order to use all features of this application."),n.a.createElement("p",null,"Press ",n.a.createElement("b",null,"Accesible")," to view the accessible stations (without rain, snow, etc)."),n.a.createElement("p",null,"Press ",n.a.createElement("b",null,"Weather")," to view the weather conditions in every station."),n.a.createElement(_.a,{className:"home-button",variant:"outline-primary",onClick:t},"Accessible"),n.a.createElement("br",null),n.a.createElement(_.a,{className:"home-button",variant:"outline-primary",onClick:a},"Weather"),!0===l?n.a.createElement("div",null,n.a.createElement("p",null," ",n.a.createElement("b",null,"Error"),": Cannot fetch data..."),n.a.createElement("p",null," We are sorry. Try again later. ")):"",!1===i&&!1===l?n.a.createElement("div",null,n.a.createElement("p",null,"Fetching data..."),n.a.createElement(p.a,{animation:"border"})):"")},f=[{device_id:"11",device_Name:"iTravel-1-Lagada",lat:"40.6474504131169920",lon:"22.9352212691169370"},{device_id:"12",device_Name:"iTravel-1-V. Olgas",lat:"40.6150064974067820",lon:"22.9541949287744270"},{device_id:"13",device_Name:"iTravel-1-LefkosPyrgos",lat:"40.6262911753818730",lon:"22.9489932096469150"},{device_id:"14",device_Name:"iTravel-1-YMCA",lat:"40.6262145694257060",lon:"22.9532791176056890"},{device_id:"15",device_Name:"iTravel-1-K. Karamanli",lat:"40.6113924511909450",lon:"22.9634620090564570"},{device_id:"17",device_Name:"iTravel-1-Dimokratias Sq.",lat:"40.6400262325646930",lon:"22.9361225991203810"},{device_id:"18",device_Name:"iTravel-1-Evagelistria",lat:"40.6343644525075620",lon:"22.9565020750901570"},{device_id:"19",device_Name:"iTravel-1-D. Isodos",lat:"40.6459148318784220",lon:"22.9176903447571480"},{device_id:"20",device_Name:"iTravel-1-Monastiriou",lat:"40.6558260774822530",lon:"22.9041176950632920"},{device_id:"21",device_Name:"iTravel-21-St. Kazantzidi",lat:"40.5737487731048890",lon:"22.9906071424238690"},{device_id:"22",device_Name:"iTravel-22-Moudanion Highway",lat:"40.5693434245466160",lon:"22.9862803705026410"},{device_id:"23",device_Name:"iTravel-23-G. Sxolis Ave.",lat:"40.5677460384070440",lon:"22.9746844097849130"},{device_id:"24",device_Name:"iTravel-24-Thermi",lat:"40.5529149127653170",lon:"23.0172994472127360"},{device_id:"25",device_Name:"iTravel-1-MarinaParking",lat:"35.1875934406409100",lon:"25.7163805686998330"},{device_id:"26",device_Name:"iTravel-1-Port",lat:"35.1911059999999980",lon:"25.7216510000000010"},{device_id:"27",device_Name:"iTravel-1-Police",lat:"35.1855927576740020",lon:"25.7067728251486190"},{device_id:"28",device_Name:"iTravel-1-MarinopoulosIntersection",lat:"35.1982292151556140",lon:"25.7088567277315860"},{device_id:"29",device_Name:"iTravel-1-AmmoudiBeach",lat:"35.1985354999999980",lon:"25.7121250000000000"},{device_id:"30",device_Name:"iTravel-1-Latous",lat:"35.1869226000000030",lon:"25.7125191999999990"},{device_id:"31",device_Name:"iTravel-31-Ag. Pavlos hospital",lat:"40.5763137554355710",lon:"22.9699537642341060"},{device_id:"32",device_Name:"iTravel-32-Panorama Interchange",lat:"40.5989177611491100",lon:"22.9970729090314310"},{device_id:"33",device_Name:"iTravel-33-Gr. Labraki",lat:"40.6114027686660390",lon:"22.9860750809189080"},{device_id:"34",device_Name:"iTravel-34-Lampraki&Kleanthous",lat:"40.6161870634187350",lon:"22.9732180126013640"},{device_id:"35",device_Name:"iTravel-35-City Center Interchange",lat:"40.6281548002886690",lon:"22.9771977402310770"},{device_id:"36",device_Name:"iTravel-36-Diavata",lat:"40.6953254527893120",lon:"22.8454167880158820"},{device_id:"37",device_Name:"iTravel-37-Kaftatzoglio",lat:"40.6220688984109230",lon:"22.9673265405040180"},{device_id:"38",device_Name:"iTravel-38-Eptapirgio Interchange",lat:"40.6441186230452090",lon:"22.9691832996945780"},{device_id:"39",device_Name:"iTravel-39-Neapoli Interchange",lat:"40.6596706712798120",lon:"22.9681942351152200"},{device_id:"40",device_Name:"iTravel-40-Papageorgiou Interchange",lat:"40.6791562325441020",lon:"22.9583545513696660"},{device_id:"41",device_Name:"iTravel-41-Stauroupoli Interchange",lat:"40.6774226390008590",lon:"22.9389474280219470"},{device_id:"42",device_Name:"iTravel-42-Neapoli",lat:"40.6574512794702090",lon:"22.9649789370637340"},{device_id:"43",device_Name:"iTravel-43-Ag. Therapondas",lat:"40.6095290320497500",lon:"22.9714112430974640"},{device_id:"44",device_Name:"iTravel-44-Stauroupoli City Hall",lat:"40.6624683325288740",lon:"22.9360030330758490"},{device_id:"45",device_Name:"iTravel-45-Ifestionos",lat:"40.6426813026083100",lon:"22.9391082599840960"},{device_id:"46",device_Name:"iTravel-46-Eleftherias Sq.",lat:"40.6340712024461300",lon:"22.9389004893641870"},{device_id:"47",device_Name:"iTravel-47-Bank of Greece",lat:"40.6351367708993790",lon:"22.9386463500600260"},{device_id:"48",device_Name:"iTravel-48-Dikastiria Intersection",lat:"40.6395031847470070",lon:"22.9308712966781060"},{device_id:"49",device_Name:"iTravel-49-Airport Intersection",lat:"40.5328818865633240",lon:"22.9939870275597970"},{device_id:"50",device_Name:"iTravel-50-Theagenio hospital",lat:"40.6183386046738590",lon:"22.9584866501431860"},{device_id:"51",device_Name:"iTravel-51-M. Botsari",lat:"40.6070110590993920",lon:"22.9511441029649180"},{device_id:"52",device_Name:"iTravel-52-Adrianoupoleos",lat:"40.5897521565682030",lon:"22.9545014575154480"},{device_id:"53",device_Name:"iTravel-53-V. Olgas",lat:"40.5945559242194350",lon:"22.9561717361048070"},{device_id:"54",device_Name:"iTravel-54-Martiou",lat:"40.6008483896048350",lon:"22.9593650735955630"},{device_id:"55",device_Name:"iTravel-55-K. Karamanli",lat:"40.5972930778242540",lon:"22.9646899290423790"},{device_id:"56",device_Name:"iTravel-56-EthnikoStadioSerron",lat:"41.0872092965976070",lon:"23.5270014662704630"},{device_id:"57",device_Name:"iTravel-57-LeofMerarchiasKilkis",lat:"41.0823389673631850",lon:"23.5426313405275780"},{device_id:"58",device_Name:"iTravel-58-PlatiaEmporiou",lat:"41.0900450761200490",lon:"23.5526652889375330"},{device_id:"59",device_Name:"iTravel-59-MegalouAlexandrouAgiasSofias",lat:"41.0922769824143900",lon:"23.5584866852674390"},{device_id:"60",device_Name:"iTravel-60-EOKavalasXanthisThsaou",lat:"40.9442489999999990",lon:"24.4271239999999990"},{device_id:"61",device_Name:"iTravel-61-PlatiaNikotsara",lat:"40.9371569999999990",lon:"24.4130840000000010"},{device_id:"62",device_Name:"iTravel-62-OmoniasGallikisDimokratias",lat:"40.9370400000000030",lon:"24.4158700000000020"},{device_id:"63",device_Name:"iTravel-63-KavalaPort",lat:"40.9345417447539430",lon:"24.4124746294651230"},{device_id:"64",device_Name:"ITravel-64-PanagiotiKanelopoulou",lat:"38.2726270000000000",lon:"21.7582939999999990"},{device_id:"65",device_Name:"ITravel-65-KalavritianouOlokaytomatos",lat:"38.2345589999999970",lon:"21.7464640000000000"},{device_id:"66",device_Name:"ITravel-66-NeoLimani",lat:"38.2319730378439500",lon:"21.7246659447746420"},{device_id:"67",device_Name:"ITravel-67-Papaflessa",lat:"38.2491701064082650",lon:"21.7349467668648230"},{device_id:"68",device_Name:"ITravel-68-PlateiaNikis",lat:"38.2567120000000000",lon:"21.7433260000000000"},{device_id:"69",device_Name:"ITravel-69-MarinaPatras",lat:"38.2411379999999990",lon:"21.7265680000000000"},{device_id:"70",device_Name:"ITravel-70-TrionSummaxon",lat:"38.2601769999999990",lon:"21.7386240000000020"},{device_id:"71",device_Name:"ITravel-71-PlateiaBasileosGeorgiou",lat:"38.2462437489333450",lon:"21.7350756491432550"},{device_id:"72",device_Name:"Thess1",lat:"40.6015794478607500",lon:"22.9697104543447490"},{device_id:"73",device_Name:"Thess2",lat:"40.5984121431745280",lon:"22.9505199193954470"},{device_id:"74",device_Name:"Thess3",lat:"40.6234628927045950",lon:"22.9621016979217530"},{device_id:"75",device_Name:"Thess4",lat:"40.6357354052651800",lon:"22.9443924129009250"},{device_id:"76",device_Name:"iTravel-76-Galatista",lat:"40.4664587348245280",lon:"23.2350982725620270"},{device_id:"77",device_Name:"iTravel-77-Nikiti",lat:"40.2227188711460640",lon:"23.6686907708644870"},{device_id:"78",device_Name:"iTravel-78-Afitos",lat:"40.1010605533676030",lon:"23.4310349822044370"},{device_id:"79",device_Name:"iTravel-79-Flogita",lat:"40.2633862034169210",lon:"23.2510399818420410"},{device_id:"80",device_Name:"iTravel-80-Lakoma",lat:"40.3877049463578710",lon:"23.0370613932609560"},{device_id:"93",device_Name:"iTravel_Malgara",lat:"40.6053700000000010",lon:"22.7166199999999990"}],E=function(e,a){var t=parseFloat(e.lat)*(Math.PI/180),i=parseFloat(a.lat)*(Math.PI/180),n=i-t,l=(parseFloat(a.lon)-parseFloat(e.lon))*(Math.PI/180);return 7917.6*Math.asin(Math.sqrt(Math.sin(n/2)*Math.sin(n/2)+Math.cos(t)*Math.cos(i)*Math.sin(l/2)*Math.sin(l/2)))},k=t(17),T=function(e){return e.map((function(e){var a=e.device_Name.replace(/[i,I]Travel-\d*-/,"").replace("iTravel_","");return Object(k.a)(Object(k.a)({},e),{},{device_Name:a})}))},b=function(e){return e.filter((function(e){return!(e.weather.weather.id<800)}))},S=t(15),g=function(e,a){return a?Object(S.a)(e).sort((function(e,t){var i={lat:e.station.lat,lon:e.station.lon},n={lat:t.station.lat,lon:t.station.lon},l=E(a,i),c=E(a,n);return l<c?-1:l>c?1:0})):e},y=t(20),C=function(e,a){var t,i=[],n=Object(y.a)(e);try{for(n.s();!(t=n.n()).done;){var l=t.value.station,c=l.device_id;a.includes(c)&&i.push({device_id:c,device_Name:l.device_Name})}}catch(r){n.e(r)}finally{n.f()}return i},w=function(e){return Object(S.a)(e).sort((function(e,a){var t=e.station.device_Name,i=a.station.device_Name;return t<i?-1:i<t?1:0}))},I=function(e){return e>=200&&e<300?"11d":e>=300&&e<400?"09d":e>=500&&e<=503?"10d":511===e?"13d":e>=520&&e<=531?"09d":e>=600&&e<700?"13d":e>=700&&e<800?"50d":800===e?"01d":801===e?"02d":802===e?"03d":803===e||804===e?"04d":(console.log("weather id does not match any available icon...",e),"01d")},A=function(e){Object(u.a)(t,e);var a=Object(h.a)(t);function t(e){var i;Object(d.a)(this,t),i=a.call(this,e);var n=w(b(i.props.stations)),l=i.props.location;return i.state={stations:n,sortedStations:g(n,l),reachableStations:[],id:"",loading:!1,filter:"",locationError:!1},i.handleClickSortStations=i.handleClickSortStations.bind(Object(m.a)(i)),i.handleClickViewStations=i.handleClickViewStations.bind(Object(m.a)(i)),i}return Object(v.a)(t,[{key:"handleClickSortStations",value:function(){this.props.location.lat?this.setState({filter:""===this.state.filter?"sortedStations":""}):this.setState({locationError:!0})}},{key:"handleClickViewStations",value:function(){var e=Object(s.a)(o.a.mark((function e(a){var t,i,n,l,c,r,s;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.setState({id:a,loading:!0}),e.prev=1,e.next=4,fetch("https://cors-anywhere.herokuapp.com/"+"http://147.102.16.156:8080/services/getItravelIdTrajectories/".concat(a));case 4:return t=e.sent,e.next=7,t.json();case 7:return i=e.sent,n=i.map((function(e){return e.trajectory_id})),e.next=11,Promise.all(n.map((function(e){return fetch("https://cors-anywhere.herokuapp.com/"+"http://147.102.16.156:8080/services/getTrajectoryIdTrajectories/".concat(e))})));case 11:return l=e.sent,e.next=14,Promise.all(l.map((function(e){return e.json()})));case 14:c=e.sent,r=c.flatMap((function(e){return e.map((function(e){return e.itravel_id}))})),s=C(this.state.stations,r),this.setState({reachableStations:s,loading:!1,id:a}),e.next=24;break;case 20:e.prev=20,e.t0=e.catch(1),this.setState({id:"",loading:!1}),console.log(e.t0);case 24:case"end":return e.stop()}}),e,this,[[1,20]])})));return function(a){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this,a=""===this.state.filter?this.state.stations:this.state.sortedStations;return n.a.createElement("div",null,n.a.createElement("p",null,n.a.createElement("b",null,"Sort")," stations ",n.a.createElement("b",null,"by distance from my location"),":"),n.a.createElement(_.a,{variant:"outline-primary",onClick:this.handleClickSortStations},"Sort"),n.a.createElement(_.a,{variant:"outline-primary",onClick:this.props.handleClickBack},"Back"),n.a.createElement("br",null),this.state.locationError?n.a.createElement("div",null,n.a.createElement("p",null,n.a.createElement("b",null,"Allow access to your location")," to use this feature. "),n.a.createElement("p",null," (Go to Settings > Privacy and security > Site settings > Location) ")):"",n.a.createElement("p",null," Press ",n.a.createElement("b",null,"view stations")," to view the reachable stations from each station. "),n.a.createElement("h3",null," Accessible Stations: "),n.a.createElement("ul",{className:"stationList"},a.map((function(a){var t=a.station,i=t.device_id;return i!==e.state.id?n.a.createElement("li",{className:"station-li",key:t.device_id},n.a.createElement("p",{className:"stationName"}," ",t.device_Name," "),n.a.createElement(_.a,{variant:"outline-primary",onClick:function(){return e.handleClickViewStations(i)}},"View stations")):!1===e.state.loading?n.a.createElement("li",{key:t.device_id},n.a.createElement("p",null," Reachable stations from ",n.a.createElement("b",null,t.device_Name),": "),n.a.createElement("ul",null,e.state.reachableStations.map((function(e){return n.a.createElement("li",{key:e.device_id},n.a.createElement("p",{className:"stationName2"}," ",e.device_Name," "))})))):n.a.createElement("li",{className:"station-li",key:t.device_id},n.a.createElement("p",{className:"stationName"}," ",t.device_Name," "),n.a.createElement(p.a,{animation:"border"}))}))))}}]),t}(n.a.Component),j=function(e){var a=e.stations,t=e.handleClickBack,i=w(a).map((function(e){var a=e.station.device_Name,t=e.station.device_id,i=e.weather,l=i.weather[0].id,c=i.weather[0].description,r=i.main.temp,o="weather-icons/"+I(l)+".png";return n.a.createElement("li",{key:t},n.a.createElement("div",{className:"station"},n.a.createElement("h3",null," ",a," "),n.a.createElement("p",null," ",n.a.createElement("b",null,"Description"),": ",c," "),n.a.createElement("img",{alt:"",src:o,width:"100",height:"100"}),n.a.createElement("p",null," ",n.a.createElement("b",null,"Temperature"),": ",r," ")))}));return n.a.createElement("div",null,n.a.createElement("h2",null," Stations weather conditions "),n.a.createElement(_.a,{variant:"outline-primary",onClick:t},"Back"),n.a.createElement("ul",null,i))},P=function(e){Object(u.a)(t,e);var a=Object(h.a)(t);function t(e){var i;return Object(d.a)(this,t),(i=a.call(this,e)).state={stations:T(f),location:{},mode:"Home",error:!1,fetchedData:!1},i.handleClickAccessibleStations=i.handleClickAccessibleStations.bind(Object(m.a)(i)),i.handleClickStationsWeather=i.handleClickStationsWeather.bind(Object(m.a)(i)),i.handleClickBack=i.handleClickBack.bind(Object(m.a)(i)),i}return Object(v.a)(t,[{key:"componentDidMount",value:function(){var e=Object(s.a)(o.a.mark((function e(){var a,t,i,n,l=this;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return navigator.geolocation.getCurrentPosition((function(e){return l.setState({location:{lat:e.coords.latitude,lon:e.coords.longitude}})})),a=this.state.stations,e.prev=2,e.next=5,Promise.all(a.map((function(e){var a=e.lat,t=e.lon;return fetch("https://api.openweathermap.org/data/2.5/weather?lat=".concat(a,"&lon=").concat(t,"&units=metric&appid=94f3c8e684ecb557e3091f514c7fe252"))})));case 5:return t=e.sent,e.next=8,Promise.all(t.map((function(e){return e.json()})));case 8:i=e.sent,n=i.map((function(e,t){return{station:a[t],weather:e}})),this.setState({fetchedData:!0,stations:n}),e.next=17;break;case 13:e.prev=13,e.t0=e.catch(2),console.log("Fetching weather data failed..."),this.setState({error:!0});case 17:case"end":return e.stop()}}),e,this,[[2,13]])})));return function(){return e.apply(this,arguments)}}()},{key:"handleClickAccessibleStations",value:function(){!0===this.state.fetchedData&&this.setState({mode:"AccessibleStations"})}},{key:"handleClickStationsWeather",value:function(){!0===this.state.fetchedData&&this.setState({mode:"StationWeather"})}},{key:"handleClickBack",value:function(){this.setState({mode:"Home"})}},{key:"render",value:function(){return n.a.createElement("div",{className:"App"},n.a.createElement("div",{className:"header"},n.a.createElement("h1",null," Appathon "),n.a.createElement("p",null," NTUA ECE ")),"AccessibleStations"===this.state.mode?n.a.createElement(A,{stations:this.state.stations,location:this.state.location,handleClickBack:this.handleClickBack}):"StationWeather"===this.state.mode?n.a.createElement(j,{stations:this.state.stations,handleClickBack:this.handleClickBack}):n.a.createElement(N,{handleClickStationsWeather:this.handleClickStationsWeather,handleClickAccessibleStations:this.handleClickAccessibleStations,error:this.state.error,fetchedData:this.state.fetchedData}))}}]),t}(n.a.Component);t(27),Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));c.a.render(n.a.createElement(n.a.StrictMode,null,n.a.createElement(P,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[21,1,2]]]);
//# sourceMappingURL=main.dce9f25b.chunk.js.map